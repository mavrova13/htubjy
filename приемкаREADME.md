
&НаСервере
Процедура ПолучитьМастеровНаСервере()
	Попытка
		HTTPСоединение = Новый HTTPСоединение("10.3.108.50");
	Исключение
		Сообщить("Не удалось подключиться с сервером");
	КонецПопытки;
	ИмяБазы = "InfoBase36/";
	HTTP = "hs/";
	ИмяФункции = "Test/";
	Шаблон = "v1/Masters";
	Параметр = "?param=";
	HTTPЗапрос = Новый HTTPЗапрос("" + ИмяБазы + HTTP + ИмяФункции + Шаблон + Параметр);
	Попытка 
		Ответ = HTTPСоединение.Получить(HTTPЗапрос);
		ОтветНаСайте = Ответ.ПолучитьТелоКакСтроку();
		
	Исключение
		Сообщить("Не удалось получить данные!");
	КонецПопытки;
	
	Чтение = Новый ЧтениеJSON;
	Чтение.УстановитьСтроку(ОтветНаСайте);
	НовыйМастер = Справочники.Мастеры.СоздатьЭлемент();
	
	Пока Чтение.Прочитать() Цикл
		ТекЗнач = Чтение.ТипТекущегоЗначения;
		Если ТекЗнач = ТипЗначенияJSON.ИмяСвойства Тогда
			ТекСвойство = Чтение.ТекущееЗначение;
		ИначеЕсли ТекЗнач = ТипЗначенияJSON.Строка или ТекЗнач = ТипЗначенияJSON.Число Тогда
			Значение = Чтение.ТекущееЗначение;
			
			Если ТекСвойство = "Name" Тогда
				НовыйМастер.Наименование = Значение;
			ИначеЕсли 
				ТекСвойство = "Login" Тогда
				НовыйМастер.Логин = Значение;
			ИначеЕсли ТекСвойство = "Password" Тогда
				НовыйМастер.Пароль = Значение; 
			ИначеЕсли ТекСвойство = "photo" Тогда
				НовыйМастер.Фотография = Новый ХранилищеЗначения(Base64Значение(Значение));
			ИначеЕсли ТекСвойство = "info" Тогда
				
				ТекДанные = НовыйМастер.ОписаниеМастеров.Добавить();
				ТекДанные.Описание = Значение;   
				
			КонецЕсли;
			
		ИначеЕсли ТекЗнач = ТипЗначенияJSON.НачалоОбъекта Тогда
			НовыйМастер= Справочники.Мастеры.СоздатьЭлемент();
		ИначеЕсли ТекЗнач = ТипЗначенияJSON.КонецОбъекта Тогда 
			     НовыйМастер.Записать();
			 КонецЕсли;
		 КонецЦикла;
		 
		 
		 
					
КонецПроцедуры

&НаКлиенте
Процедура ПолучитьМастеров(Команда)
	ПолучитьМастеровНаСервере();
КонецПроцедуры
